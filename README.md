# ğŸ“º Short-Tube: AI-Powered YouTube Monitoring (React + Express)

**Short-Tube**ëŠ” ì‚¬ìš©ìê°€ ê´€ì‹¬ ìˆëŠ” ìœ íŠœë¸Œ ì±„ë„ì„ ëª¨ë‹ˆí„°ë§í•˜ê³ , ìƒˆë¡œìš´ ì˜ìƒì´ ì˜¬ë¼ì˜¤ë©´ **Gemini AI**ë¥¼ í†µí•´ ë‚´ìš©ì„ ìš”ì•½í•˜ì—¬ ë¸Œë¦¬í•‘í•´ì£¼ëŠ” ìŠ¤ë§ˆíŠ¸ ë¹„ì„œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

**v2.0**: Python Streamlitì—ì„œ Next.js + Express BFF êµ¬ì¡°ë¡œ ì™„ì „ ì¬êµ¬ì¶•

![Next.js](https://img.shields.io/badge/Next.js-000000?style=for-the-badge&logo=next.js&logoColor=white)
![React](https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=react&logoColor=black)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=typescript&logoColor=white)
![Express](https://img.shields.io/badge/Express-000000?style=for-the-badge&logo=express&logoColor=white)
![Node.js](https://img.shields.io/badge/Node.js-339933?style=for-the-badge&logo=node.js&logoColor=white)
![Gemini AI](https://img.shields.io/badge/Gemini_AI-4285F4?style=for-the-badge&logo=google-gemini&logoColor=white)

---

## âœ¨ í•µì‹¬ ê¸°ëŠ¥ (Key Features)

### 1. ì§€ëŠ¥í˜• ìœ íŠœë¸Œ ëª¨ë‹ˆí„°ë§
- **í‚¤ì›Œë“œ í•„í„°ë§**: ì±„ë„ë³„ë¡œ ê´€ì‹¬ ìˆëŠ” íƒœê·¸(í‚¤ì›Œë“œ)ë¥¼ ì„¤ì •í•˜ì—¬ ê´€ë ¨ ì˜ìƒë§Œ ì¶”ì¶œ
- **ì´ì¤‘ ë°ì´í„° ìˆ˜ì§‘**: YouTube Data API(v3)ë¥¼ ìš°ì„  ì‚¬ìš©í•˜ë©°, í• ë‹¹ëŸ‰ ì´ˆê³¼ ì‹œ ìë™ìœ¼ë¡œ **RSS Feed**ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘
- **ìŠ¤ë§ˆíŠ¸ ìºì‹±**: ì˜ìƒ ëª©ë¡ì„ ë¡œì»¬ì— ìºì‹±í•˜ì—¬ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ìµœì†Œí™”

### 2. Gemini AI ê¸°ë°˜ ìš”ì•½ (AI Summarization)
- **ìë§‰ ë¶„ì„**: ì˜ìƒì˜ ìë§‰ì„ ì¶”ì¶œí•˜ì—¬ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½ (í•œêµ­ì–´ â†’ ì˜ì–´ â†’ ëª¨ë“  ì–¸ì–´ í´ë°±)
- **ê´€ì‹¬ì‚¬ ë§ì¶¤í˜•**: ì‚¬ìš©ìê°€ ì„¤ì •í•œ íƒœê·¸ì— ë§ì¶° ìš”ì•½ í¬ì¸íŠ¸ë¥¼ ìµœì í™”
- **ëª¨ë¸ í´ë°±**: Gemini 2.5 Flash â†’ 2.0 Flash Lite â†’ Flash Latest â†’ 1.5 Flash ìˆœì„œë¡œ ìë™ í´ë°±

### 3. ë°ì¼ë¦¬ ë¸Œë¦¬í•‘ & ì•Œë¦¼
- **ì¼ì¼ í†µí•© ë¦¬í¬íŠ¸**: í•˜ë£¨ ë™ì•ˆ ìˆ˜ì§‘ëœ ëª¨ë“  ì˜ìƒ ìš”ì•½ì„ í•˜ë‚˜ì˜ ìœ ê¸°ì ì¸ ë¸Œë¦¬í•‘ ë¦¬í¬íŠ¸ë¡œ í†µí•©
- **í…”ë ˆê·¸ë¨ ì•Œë¦¼**: ì‹¤ì‹œê°„ ì˜ìƒ ìš”ì•½ ì•Œë¦¼ ë° ì˜ˆì•½ëœ ì‹œê°„ì— ë°ì¼ë¦¬ ë¸Œë¦¬í•‘ì„ í…”ë ˆê·¸ë¨ìœ¼ë¡œ ì „ì†¡
- **ì•„ì¹´ì´ë¸Œ**: ê³¼ê±°ì— ì§„í–‰ëœ ëª¨ë“  ìš”ì•½ ë‚´ì—­ì„ ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸ ê°€ëŠ¥

### 4. ìë™í™”ëœ ë°±ê·¸ë¼ìš´ë“œ ëª¨ë‹ˆí„°ë§
- **ìŠ¤ì¼€ì¤„ëŸ¬**: node-cronì„ ì‚¬ìš©í•œ ì •í™•í•œ ì‹œê°„ ê¸°ë°˜ ì‹¤í–‰
- **ì§€ëŠ¥í˜• ì²˜ë¦¬**: ìƒˆ ì˜ìƒë§Œ ê°ì§€í•˜ì—¬ ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
- **Rate Limiting**: API ìš”ì²­ ì œí•œì„ ì¤€ìˆ˜í•˜ëŠ” ì•ˆì „í•œ ì²˜ë¦¬

---

## ğŸ›  Tech Stack

### Frontend (Coming Soon - Phase 3-5)
- **Framework**: Next.js 14+ (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS + shadcn/ui
- **State Management**: React Query + Zustand
- **Forms**: React Hook Form + Zod

### Backend (âœ… Completed - Phase 1-2)
- **Framework**: Express.js
- **Language**: TypeScript
- **AI Model**: Google Gemini (multiple models with fallback)
- **Scheduling**: node-cron
- **Data Fetching**: YouTube Data API v3, RSS (fast-xml-parser)
- **YouTube**: googleapis, youtube-transcript, yt-dlp
- **Notification**: Telegram (node-telegram-bot-api)
- **Storage**: JSON-based Local Persistence
- **Validation**: Zod

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡° (Project Structure)

```
short-tube/
â”œâ”€â”€ package.json                    # Monorepo workspace config
â”œâ”€â”€ ecosystem.config.js             # PM2 configuration
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ types/                      # Shared TypeScript types
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ index.ts           # All shared type definitions
â”‚
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                        # Next.js Frontend (Phase 3-5)
â”‚   â”‚   â””â”€â”€ (coming soon)
â”‚   â”‚
â”‚   â””â”€â”€ server/                     # Express BFF (âœ… Completed)
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â”œâ”€â”€ nodemon.json
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ index.ts            # Server entry point
â”‚           â”œâ”€â”€ app.ts              # Express app setup
â”‚           â”œâ”€â”€ scheduler.ts        # node-cron scheduler
â”‚           â”‚
â”‚           â”œâ”€â”€ routes/             # API routes
â”‚           â”‚   â”œâ”€â”€ subscriptions.ts
â”‚           â”‚   â”œâ”€â”€ videos.ts
â”‚           â”‚   â”œâ”€â”€ summaries.ts
â”‚           â”‚   â”œâ”€â”€ briefing.ts
â”‚           â”‚   â”œâ”€â”€ settings.ts
â”‚           â”‚   â””â”€â”€ monitor.ts
â”‚           â”‚
â”‚           â”œâ”€â”€ controllers/        # Route controllers
â”‚           â”œâ”€â”€ services/           # Business logic
â”‚           â”‚   â”œâ”€â”€ data.service.ts         # JSON file operations
â”‚           â”‚   â”œâ”€â”€ youtube.service.ts      # YouTube API + RSS
â”‚           â”‚   â”œâ”€â”€ transcript.service.ts   # Caption extraction
â”‚           â”‚   â”œâ”€â”€ gemini.service.ts       # AI summarization
â”‚           â”‚   â”œâ”€â”€ audio.service.ts        # yt-dlp wrapper
â”‚           â”‚   â””â”€â”€ notifier.service.ts     # Telegram notifications
â”‚           â”‚
â”‚           â”œâ”€â”€ jobs/               # Background jobs
â”‚           â”‚   â””â”€â”€ monitor.job.ts  # Monitoring & briefing logic
â”‚           â”‚
â”‚           â”œâ”€â”€ lib/                # External clients
â”‚           â”‚   â”œâ”€â”€ youtube-client.ts
â”‚           â”‚   â”œâ”€â”€ gemini-client.ts
â”‚           â”‚   â”œâ”€â”€ telegram-client.ts
â”‚           â”‚   â””â”€â”€ file-storage.ts
â”‚           â”‚
â”‚           â”œâ”€â”€ middleware/         # Express middleware
â”‚           â”‚   â”œâ”€â”€ error-handler.ts
â”‚           â”‚   â”œâ”€â”€ logger.ts
â”‚           â”‚   â””â”€â”€ validate.ts
â”‚           â”‚
â”‚           â”œâ”€â”€ schemas/            # Zod validation schemas
â”‚           â””â”€â”€ utils/              # Utilities
â”‚
â””â”€â”€ data/                           # JSON data storage
    â”œâ”€â”€ data.json                   # User settings + subscriptions
    â”œâ”€â”€ summaries.json              # Video summaries + briefings
    â””â”€â”€ video_cache.json            # Cached video lists
```

---

## ğŸš€ ì‹œì‘í•˜ê¸° (Quick Start)

### 1. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# Clone repository
git clone <repository-url>
cd short-tube

# Install all dependencies
npm install
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`apps/server/.env.example` íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ `apps/server/.env` íŒŒì¼ì„ ë§Œë“¤ê³  í•„ìš”í•œ API í‚¤ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

```bash
cp apps/server/.env.example apps/server/.env
```

`.env` íŒŒì¼ ë‚´ìš©:

```env
# Server
NODE_ENV=development
PORT=3001
CORS_ORIGIN=http://localhost:3000

# Google APIs
GOOGLE_API_KEY=your_gemini_api_key_here
YOUTUBE_API_KEY=your_youtube_api_key_here

# Telegram (optional)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHAT_ID=your_telegram_chat_id

# Paths
DATA_DIR=../../data
TEMP_AUDIO_DIR=../../temp_audio
```

**API í‚¤ ë°œê¸‰ ë°©ë²•:**
- **YouTube API Key**: [Google Cloud Console](https://console.cloud.google.com/) â†’ API & Services â†’ Credentials
- **Gemini API Key**: [Google AI Studio](https://makersuite.google.com/app/apikey)
- **Telegram Bot**: [BotFather](https://t.me/botfather)ì—ì„œ ë´‡ ìƒì„±

### 3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰

```bash
# Development mode
npm run server:dev

# Production build
npm run server:build

# Production start
npm run server:start
```

ì„œë²„ê°€ ì‹œì‘ë˜ë©´:
- ğŸš€ Server: http://localhost:3001
- ğŸ“ Health check: http://localhost:3001/health
- ğŸ“ API docs: http://localhost:3001/api

---

## ğŸ“¡ API Endpoints

### Subscriptions
- `GET /api/subscriptions` - êµ¬ë… ëª©ë¡ ì¡°íšŒ
- `POST /api/subscriptions` - ì±„ë„ ì¶”ê°€
- `PATCH /api/subscriptions/:channelId` - êµ¬ë… ì—…ë°ì´íŠ¸ (íƒœê·¸, í™œì„±í™”)
- `DELETE /api/subscriptions/:channelId` - ì±„ë„ ì‚­ì œ

### Videos
- `GET /api/videos/channel/:channelId` - ì±„ë„ ì˜ìƒ ëª©ë¡
- `POST /api/videos/refresh/:channelId` - ì˜ìƒ ìºì‹œ ê°±ì‹ 

### Summaries
- `GET /api/summaries` - ìš”ì•½ ëª©ë¡ (í•„í„°ë§ ì§€ì›)
- `POST /api/summaries` - ìš”ì•½ ìƒì„±
- `GET /api/summaries/date/:date` - ë‚ ì§œë³„ ìš”ì•½

### Briefing
- `GET /api/briefing/:date` - ë¸Œë¦¬í•‘ ì¡°íšŒ
- `POST /api/briefing/generate` - ë¸Œë¦¬í•‘ ìƒì„±

### Settings
- `GET /api/settings` - ì„¤ì • ì¡°íšŒ
- `PATCH /api/settings` - ì„¤ì • ì—…ë°ì´íŠ¸
- `POST /api/settings/telegram/test` - í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸

### Monitor
- `POST /api/monitor/trigger` - ìˆ˜ë™ ëª¨ë‹ˆí„°ë§ íŠ¸ë¦¬ê±°

---

## âš™ï¸ ë°±ê·¸ë¼ìš´ë“œ ëª¨ë‹ˆí„°ë§

ì„œë²„ê°€ ì‹œì‘ë˜ë©´ ìë™ìœ¼ë¡œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤:

1. **ë§¤ ë¶„ë§ˆë‹¤ ì²´í¬**: ì„¤ì •ëœ ì•Œë¦¼ ì‹œê°„ì´ ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. **ìë™ ì‹¤í–‰**: ì•Œë¦¼ ì‹œê°„ì— ë„ë‹¬í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ì‹œì‘
3. **ìƒˆ ì˜ìƒ ê°ì§€**: ê° í™œì„± êµ¬ë…ì—ì„œ ìƒˆë¡œìš´ ì˜ìƒ ì°¾ê¸°
4. **ìš”ì•½ ìƒì„±**: Gemini AIë¡œ ì˜ìƒ ìš”ì•½ (ìë§‰ ìš°ì„ , í´ë°± ì§€ì›)
5. **í…”ë ˆê·¸ë¨ ì•Œë¦¼**: ìš”ì•½ ë‚´ìš©ì„ í…”ë ˆê·¸ë¨ìœ¼ë¡œ ì „ì†¡
6. **ë°ì¼ë¦¬ ë¸Œë¦¬í•‘**: ëª¨ë“  ìš”ì•½ì„ í†µí•©í•œ ë¸Œë¦¬í•‘ ìƒì„± ë° ë°œì†¡

### ìˆ˜ë™ ì‹¤í–‰

```bash
# APIë¥¼ í†µí•œ ìˆ˜ë™ íŠ¸ë¦¬ê±°
curl -X POST http://localhost:3001/api/monitor/trigger \
  -H "Content-Type: application/json" \
  -d '{"briefing": true}'
```

---

## ğŸ”§ Production Deployment

### PM2 ì‚¬ìš©

```bash
# PM2 ì„¤ì¹˜
npm install -g pm2

# ë¹Œë“œ
npm run build

# PM2ë¡œ ì‹œì‘
pm2 start ecosystem.config.js

# ë¡œê·¸ í™•ì¸
pm2 logs short-tube-server

# ì¬ì‹œì‘
pm2 restart short-tube-server

# ì‹œìŠ¤í…œ ë¶€íŒ… ì‹œ ìë™ ì‹œì‘
pm2 startup
pm2 save
```

---

## ğŸ”‘ Requirements

### Software
- **Node.js**: 18.0.0 ì´ìƒ
- **npm**: 9.0.0 ì´ìƒ
- **yt-dlp**: ì˜¤ë””ì˜¤ ë‹¤ìš´ë¡œë“œìš© (ì„ íƒì‚¬í•­)

### yt-dlp ì„¤ì¹˜

```bash
# macOS
brew install yt-dlp

# Linux
sudo wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O /usr/local/bin/yt-dlp
sudo chmod a+rx /usr/local/bin/yt-dlp

# pip
pip install yt-dlp
```

---

## ğŸ“ Migration Progress

- âœ… **Phase 1**: ë°±ì—”ë“œ ê¸°ë°˜ êµ¬ì¶• (ì™„ë£Œ)
  - Monorepo êµ¬ì¡° ì„¤ì •
  - ê³µìœ  íƒ€ì… íŒ¨í‚¤ì§€
  - Express ì„œë²„ ì´ˆê¸°í™”
  - ëª¨ë“  í•µì‹¬ ì„œë¹„ìŠ¤ êµ¬í˜„
  - API ë¼ìš°íŠ¸ ë° ì»¨íŠ¸ë¡¤ëŸ¬
  - Zod ê²€ì¦

- âœ… **Phase 2**: ìŠ¤ì¼€ì¤„ëŸ¬ & ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… (ì™„ë£Œ)
  - node-cron ìŠ¤ì¼€ì¤„ëŸ¬
  - ëª¨ë‹ˆí„°ë§ Job
  - ë¸Œë¦¬í•‘ Job
  - PM2 ì„¤ì •

- â³ **Phase 3**: Next.js í”„ë¡ íŠ¸ì—”ë“œ ì½”ì–´ (ì˜ˆì •)
- â³ **Phase 4**: ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ êµ¬í˜„ (ì˜ˆì •)
- â³ **Phase 5**: ë¸Œë¦¬í•‘ & ì•„ì¹´ì´ë¸Œ í˜ì´ì§€ (ì˜ˆì •)
- â³ **Phase 6**: í…ŒìŠ¤íŠ¸ & ë°°í¬ ì¤€ë¹„ (ì˜ˆì •)

---

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ê°œì¸ í•™ìŠµ ë° ë„êµ¬ í™œìš© ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
